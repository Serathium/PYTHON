name: Test Automation (API)

on: [push, pull_request]

jobs:
    test:
        runs-on: ubuntu-latest

        steps:
        - name: Download Code (Checkout)
          uses: actions/checkout@v4

        - name: Configure Python
          uses: actions/setup-python@v4
          with:
            python-version: '3.12'

        - name: Install Dependencies
          run: |
            python -m pip install --upgrade pip
            pip install -r requirements.txt

        - name: Install Playwright Browsers
          run: playwright install chromium

        - name: Run API Tests
          run: pytest test_api_users.py

        - name: Store Error Log (Artifacts)
          if: failure()
          uses: actions/upload-artifact@v4
          with:
            name: error-log
            path: test-results/